<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Andrew Horn de Borba">
 
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
 
    <link rel="shortcut icon" href="../imagem/icon.png" type="image/x-icon">
    <title>Clientes</title>
    </head>
    <body>
        <div>
            <h1>Consulta API Dicionário Aberto</h1>
            <input type="text" id="inputPalavra" placeholder="Digite aqui uma palavra">
            <button onClick="trataConsultarBtn()">Consultar</button>
            <button onClick="trataLimparBtn()">Limpar</button>
            <div style="margin-top:15px"id="loadingDiv"></div>
            <p id="wordResponse"></p>
        </div>


        <script>
            function trataConsultarBtn() {
                // Apresenta GIF de "loading"
                document.getElementById('loadingDiv').innerHTML = '<img id="loadingImg" style="width:30px" src="https://i.gifer.com/ZKZg.gif">';

                limpaResultados();
                
                const palavra = document.getElementById("inputPalavra").value;
                const urlWord = `https://api.dicionario-aberto.net/word/${palavra}`;
                fetch(urlWord, {
                    method : "GET",
                })
                .then( (resp) => resp.json() )
                .then( (data) => {
                    //tratar o resultado "data" no formato json
                    apresentaResultadoWord(data);
                })

            }

            function apresentaResultadoWord(data) {
                // Remove GIF de "loading"
                document.getElementById('loadingDiv').innerHTML = '';

                var conteudo;
                if(data.length == 0) {
                    conteudo = 'Não foram encontradas definições para este termo!'
                }
                else {
                    conteudo = '<strong>Definições:</strong><br><br>';
                    for (let index = 0; index < data.length; index++) {
                        const definicao = data[index];
                        conteudo += definicao.xml + '<br><br>';
                    }
                }
                const elem = document.getElementById('wordResponse');
                elem.innerHTML = conteudo;
            }

            function trataLimparBtn() {
                limpaInputs();
                limpaResultados();
            }

            function limpaInputs() {
                document.getElementById("inputPalavra").value = '';
            }

            function limpaResultados() {
                document.getElementById("wordResponse").innerHTML = ''
            }

        </script>
    </body>

</html>